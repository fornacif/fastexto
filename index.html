<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="utf-8">
		<title>SMS Sender</title>
		<meta name="viewport" content="width=device-width, initial-scale=1.0">
		<meta name="description" content="SMS Sender">
		<meta name="author" content="FranÃ§ois Fornaciari">
		<link href="./bootstrap/css/bootstrap.min.css" rel="stylesheet">
		<link href="./jgrowl/jquery.jgrowl.css" rel="stylesheet">
		<link href="./css/style.css" rel="stylesheet">
		<link href="./bootstrap/css/bootstrap-responsive.min.css" rel="stylesheet">
	</head>
	<body>
		<div class="navbar navbar-inverse navbar-fixed-top">
      <div class="navbar-inner">
        <div class="container">
          <a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </a>
          <a class="brand" href="/">SMS Sender</a>
          <div class="nav-collapse collapse">
            <p class="navbar-text pull-right">
              {{ nickname }} (<a href="{{ logoutURL }}" class="navbar-link">log out</a>)
            </p>
            <ul class="nav">
              <li class="active"><a href="/">Home</a></li>
              <li><a href="/contacts">Contacts</a></li>
              <li><a href="/account">Account</a></li>
            </ul>
          </div>
        </div>
      </div>
    </div>
		<div class="container">
			<form id="sendForm" action="/send" method="post" accept-charset="UTF-8" autocomplete="off">
				<fieldset>
					<label>Contact</label>
					<input type="text" list="contacts" name="name" class="required"/>
					<datalist id="contacts">
						{% for contact in contacts %}
						<option label="{{ contact.key().name() }}" value="{{ contact.name }}" />
						{% endfor %}
					</datalist>
					<label>Message</label>
						<textarea id="message" name="message" rows="5" class="required"></textarea>
					<label id="messageLengthLabel">0 SMS (0 chars)</label>
					<div class="form-actions">
						<button type="submit" class="btn btn-primary">Send SMS</button>
					</div>
				
					</fieldset>
			</form>
			<hr>
			<div class="footer">
				<p>&copy; fornacif 2013</p>
			</div>
		</div>
		<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.8/jquery.min.js"></script>
		<script src="http://jzaefferer.github.com/jquery-validation/jquery.validate.js"></script>
		<script src="./bootstrap/js/bootstrap.min.js"></script>
		<script src="http://malsup.github.com/jquery.form.js"></script>
		<script src="http://malsup.github.com/jquery.blockUI.js"></script>
		<script type="text/javascript">
			$(document).ready(function(){
				$("#sendForm").validate();
				
				$("#message").keyup(function() {
					var currentString = $("#message").val();
					var numMessages = Math.floor(currentString.length / 160);
					if ((currentString.length % 160) > 0) {
						numMessages++;
					}
					$("#messageLengthLabel").html(numMessages + " SMS (" + currentString.length + " chars)");
				});
			
				var options = {
					beforeSubmit: function () {
						$.blockUI({"message" : "<h3>Sending SMS...</h3>"});
					},
					success: function () {
						$("#sendForm").clearForm();
						$.unblockUI();
						$("#messageLengthLabel").text("0 SMS (0 chars)");
					}
				};
		
				$("#sendForm").ajaxForm(options);
			});
		</script>
	</body>
</html>